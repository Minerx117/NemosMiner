<!--#include file="/parts/head.html" -->
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h2 data-navbaractive="navconfigedit">Edit Configuration</h2>
          </div>
          <div id="configfilenames" class="alert alert-info" role="alert">&ensp;</div>
          <form id="configuration">
            <input name="submit" type="submit" id="save-button" value="Apply configuration" class="btn btn-success" alt="Submit" title="Apply configuration&#10;It will become active in next cycle.">
            <input name="reset" type="reset" id="reset-button" value="Reset" class="btn btn-warning" alt="Reset" title="Reset configuration data to previous values">
            <button type="button" class="btn btn-primary" id="btn-editconfig" name="btn-editconfig" title="Edit Config file&#10;It will become active in next cycle.">Edit Config file</button>
            <button type="button" class="btn btn-primary" id="btn-editpoolsconfig" name="btn-editpoolsconfig" title="Edit PoolsConfig file&#10;It will become active in next cycle.">Edit PoolsConfig file</button>
            <div>
              <br>
            </div>
            <table>
              <tr style="vertical-align: top; line-height: 125%">
                <td>
                  <!-- Wallet Addresses and User Names -->
                  <legend title="Define your wallet and user names.&#10;All your earnings will be sent to the accounts defined here.&#10;Correct data is essential." class=h6><b>Wallet Addresses and User Names</b></legend>
                  <fieldset style="padding-top: 0.3rem" title="Set your wallet addresses&#10;To add more currencies you need to edit pools config file manually.">
                    <div id="Wallets"></div>
                  </fieldset>
                  <div style="padding-top: 0.7rem" title="Identifies your worker&#10;e.g. Computername&#10;(min. 2 and max. 32 characters)">
                    <label for="WorkerName">Worker name</label>
                    <input type="text" id="WorkerName" name="WorkerName" maxlength=33 size=38 value="Workername">
                  </div>
                  <br>

                  <legend class=h6 title="You must have a registered account with Mining Pool Hub">Mining Pool Hub
                    <a id="RegisterMiningPoolHub" href="https://miningpoolhub.com/index.php?page=register" target="_blank" hidden style="float: right;" title="Click here to go to the pool registration web site to register an account">Goto registration page</a>
                  </legend>
                  <div style="padding-top: 0.2rem" title="Your username as registered with Mining Pool Hub&#10;(min. 2 and max. 32 characters)">
                    <label for="MiningPoolHubUserName">Mining Pool Hub user name</label>
                    <input type="text" id="MiningPoolHubUserName" name="MiningPoolHubUserName" maxlength=33 size=38>
                  </div>
                  <div title="Your Mining Pool Hub API Key&#10;taken from your Mining Pool Hub account settings&#10;If left empty NemosMiner cannot retrieve balance data from MiningPoolHub">
                    <label for="MiningPoolHubAPIKey">Mining Pool Hub API key</label>
                    <input type="text" id="MiningPoolHubAPIKey" name="MiningPoolHubAPIKey" maxlength=65 size=70>
                  </div>
                  <br>

                  <legend class=h6 title="You must have a registered account with NiceHash">NiceHash
                    <a id="RegisterNiceHash" href="https://www.nicehash.com/my/register" target="_blank" hidden style="float: right;" title="Click here to go to the pool registration web site to register an account">Goto registration page</a>
                  </legend>
                  <div style="padding-top: 0.2rem" title="Your NiceHash Bitcoin wallet address (must be 34 chars long)&#10;configure only if different from main Bitcoin wallet address">
                    <label for="NiceHashWallet">NiceHash Bitcoin wallet address</label>
                    <input type="text" id="NiceHashWallet" name="NiceHashWallet" maxlength=35 size=40>
                    <input title="Tick if NiceHash wallet is a NiceHash internal address&#10;&#10;Note: NiceHash internal wallets have lower pool fees" type="checkbox" class="toggle-switch" id="NiceHashWalletIsInternal" name="NiceHashWalletIsInternal">
                    <label title="Tick if NiceHash wallet is a NiceHash internal address&#10;&#10;Note: NiceHash internal wallets have lower pool fees" for="NiceHashWalletIsInternal">is internal</label>
                  </div>
                  <div title="Your NiceHash API Key&#10;taken from your NiceHash account settings&#10;If left empty NemosMiner cannot retrieve balance data from NiceHash internal wallet" for="NiceHashAPIKey">
                    <label for="NiceHashAPIKey">NiceHash API key</label>
                    <input type="text" id="NiceHashAPIKey" name="NiceHashAPIKey" maxlength=37 size=42>
                  </div>
                  <div title="Your NiceHash API Secret Key&#10;taken from your NiceHash account settings&#10;If left empty NemosMiner cannot retrieve balance data from NiceHash internal wallet" for="NiceHashAPISecret">
                    <label for="NiceHashAPISecret">NiceHash API secret</label>
                    <input type="text" id="NiceHashAPISecret" name="NiceHashAPISecret" maxlength=73 size=73>
                  </div>
                  <div title="Your NiceHash Organization Id (must be 36 chars long)&#10;taken from your NiceHash account settings&#10;If left empty NemosMiner cannot retrieve balance data from NiceHash internal wallet" for="NiceHashOrganizationId">
                    <label for="NiceHashOrganizationId">NiceHash organization Id</label>
                    <input type="text" id="NiceHashOrganizationId" name="NiceHashOrganizationId" maxlength=37 size=42>
                  </div>
                  <br>

                  <legend class=h6 title="You must have a registered account with ProHashing">ProHashing
                    <a id="RegisterProHashing" href="https://prohashing.com?r=3pH68Dhj" target="_blank" hidden style="float: right;" title="Click here to go to the pool registration web site to register an account">Goto registration page</a>
                  </legend>
                  <div style="padding-top: 0.2rem" title="Your username as registered with ProHashing" for="ProHashingUserName">
                    <label for="ProHashingUserName">ProHashing user name</label>
                    <input type="text" id="ProHashingUserName" name="ProHashingUserName" maxlength=37 size=42>
                  </div>
                  <div title="Your ProHashing API key&#10;taken from your ProHashing account settings&#10;If left empty NemosMiner cannot retrieve balance data from ProHashing" for="ProHashingAPIKey">
                    <label for="ProHashingAPIKey">ProHashing API key</label>
                    <input type="text" id="ProHashingAPIKey" name="ProHashingAPIKey" maxlength=65 size=70>
                  </div>
                  <div title="ProHashing mining mode&#10;Google for more information on PPS & PPLNS" for="ProHashingMiningMode">
                    <label for="ProHashingMiningMode">ProHashing mining mode</label>
                    <select name="" id="ProHashingMiningMode">
                      <option title="Pay Per Share (high pool fee)" value=PPS>PPS</option>
                      <option title="Pay Per Last N Shares (lower pool fee)" value=PPLNS>PPLNS</option>
                    </select>
                  </div>
                  <br>

                  <!-- Currency Settings -->
                  <legend class=h6><b>Currency Settings</b></legend>
                  <div title="Main currency used for BTC conversion&#10;Power cost, profit and earnings are shown in this currency">Main currency
                    <select id="Currency" name="Currency" style="margin-top: 0.2rem"></select>
                  </div>
                  <div title="Default payout currency for all pools&#10;Important: Not all pools allow payouts in currencies other than BTC.&#10;Consult the pool API for more information&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')">Default payout currency
                    <select id="PayoutCurrency" name="PayoutCurrency" style="margin-top: 0.2rem"></select>
                  </div>
                  <div title="Extra currencies to be shown in balances summary.&#10;Values must be separated by commas.&#10;&#10;Enter 'real-world' or crypto currencies&#10;mBTC (milli BTC) is also supported" for="ExtraCurrencies" style="padding-top: 0.3rem">Extra currencies</label>
                    <input title="Extra currencies to be shown in balances summary. &#10;Values must be separated by commas. &#10;&#10;Enter 'real-world' or crypto currencies&#10;mBTC (milli BTC) is also supported" type="text" id="ExtraCurrencies" name="ExtraCurrencies" maxlength=45 size=50 value="USD, ETC">
                  </div>
                  <div style="padding-top: 0.5rem" title="If ticked NemosMiner will display BTC values in milli BTC">
                    <input type="checkbox" class="toggle-switch" id="UsemBTC" name="UsemBTC"> Show BTC values in mBTC (BTC/1000)
                  </div>
                  <br>

                  <!-- General Settings -->
                  <legend class=h6><b>General Settings</b></legend>
                  <label style="padding-top: 0.5rem" for="StartupMode" title="Defines NemosMiner startup mode">NemosMiner starts in</label>
                  <select size=1 name="" required id="StartupMode">
                    <option value="Idle" title="Initiate application, but do not start mining or run any background processes&#10;&#10;Same as pressing the 'Stop Mining' button">idle</option>
                    <option value="Paused" title="Initiate application and run background processes, but do not start mining&#10;&#10;Same as pressing the 'Pause Mining' button">paused</option>
                    <option value="Running" title="Initiate application and start mining&#10;&#10;Same as pressing the 'Start Mining' button">running</option>
                  </select>
                  <label for="StartupMode" title="Defines NemosMiner startup mode">mode</label>
                  <div title="Mining will start when system is idle, e.g. no mouse&#10;or keyboard activity is detected for n seconds&#10;&#10;(min=0, max=3600 [default=120] seconds)&#10;&#10;Mining will stop when mouse or keyboard activity is detected.">
                    <input type="checkbox" class="toggle-switch" id="IdleDetection" name="IdleDetection"> Idle detection: Start mining when system is idle for
                    <input type="number" id="IdleSec" name="IdleSec" min=0 max=3600 value=120 step=1 size=4> seconds
                  </div>
                  <div style="padding-top: 0.5rem" title="Start the legacy GUI as minimized window">
                    <input type="checkbox" class="toggle-switch" id="StartGUIMinimized" name="StartGUIMinimized"> Start legacy GUI minimized
                  </div>
                  <div style="padding-top: 0.7rem" title="Watchdog will monitor pools & miners for frequent failures&#10;and suspend failing pools or miners for some cycles.">
                    <input type="checkbox" class="toggle-switch" id="Watchdog" name="Watchdog"> Activate watchdog (recommended)
                  </div>
                  <div style="padding-top: 0.7rem" title="Computer will restart when a dead miner is detected&#10;(e.g. miner cannot get stopped gracefully)">
                    <input type="checkbox" class="toggle-switch" id="AutoReboot" name="AutoReboot"> Restart computer on dead miners
                  </div>
                  <div style="padding-top: 0.5rem" title="Donation duration per day&#10;&#10;Please help support the great team behind NemosMiner&#10;by leaving mining donations turned on&#10;(min=0, max=60 [default 13 &#8792; 0.9%] minutes)"> Donation 
                    <input type="number" id="Donate" name="Donate" min=0 max=60 value=13> minutes per day
                  </div>
                  <div style="padding-top: 0.3rem" title="Cycle duration&#10;This defines the approximate duration for one cycle.&#10;(min=30, max=3600 [default 90] seconds)" for="Interval">Cycle duration
                    <input type="number" id="Interval" name="Interval" min=30 max=3600 step=1 value=90> seconds
                  </div>
                  <div style="padding-top: 0.3rem" title="Defines the minimum number of data samples to be collected from the miner&#10;while benchmarking before ending the cycle. Smaller numbers will&#10;cause faster benchmarking but the measured data will be less accurate&#10;(min=10, max=100 [Default: 20] samples)" for="MinDataSamples">Minimum
                    <input type="number" id="MinDataSamples" name="MinDataSamples" min=10 max=100 value=20 step=1 size=4> data samples while benchmarking
                  </div>
                  <div style="padding-top: 0.3rem" title="Minimum number of full cycles a miner must mine continously&#10;the same algorithm@pool before switching is allowed&#10;&#10;e.g. 3 would force a miner to stick mining the same algorithm@pool&#10;for at least 3 full cycles before switching to another algorithm or pool&#10;(min=1, max=10 [Default: 1] cycles)&#10;&#10;Note: This does not apply when benchmarking" for="MinInterval"> Enforce mining for at least
                    <input type="number" id="MinInterval" name="MinInterval" min=1 max=10 value=0 step=1 size=2> full cycles before switching
                  </div>
                  <!-- <select name="" id="SSL">
                    <option value="Never" title="Never use SSL for pool connections">Never use</option>
                    <option value="Prefer" title="Prefer SSL pool connections">Prefer</option>
                    <option value="Enforce" title="Enforce SSL for pool connections&#10;Pools that do not allow SSL are ignored">Enforce</option>
                  </select>
                  <label for="SSL"> SSL for Pool Connections</label> -->
                  <div style="padding-top: 0.3rem" title="Enter Proxy IP address and port&#10;e.g. 192.168.1.1:3128"> Proxy
                    <input type="text" id="Proxy" name="Proxy" maxlength=22 size=30>
                  </div>
                  <div style="padding-top: 0.5rem" title="If enabled NemosMiner will open firewall ports for all miners&#10;Admin rights required (or you must accept the UAC prompts)">
                    <input type="checkbox" class="toggle-switch" id="OpenFirewallPorts" name="OpenFirewallPorts"> Open firewall ports (admin rights required)
                  </div>
                  <br>

                  <!-- Auto Update Settings -->
                  <fieldset>
                    <legend class=h6><b>Auto Update Settings</b></legend>
                    <div style="padding-top: 0.3rem" title="NemosMiner will periodically check for a new program version&#10;(min=0; max=30; [Default: 1; 0 to disable] days)"> Check for new version every
                      <input type="number" id="AutoUpdateCheckInterval" name="AutoUpdateCheckInterval" min=0 max=50 step=1 value=15> days
                    </div>
                    <div style="padding-top: 0.5rem" title="Automatically update NemosMiner to the latest realeased program version&#10;NemosMiner will check for a new verwsion on each start&#10;and approx. every 24hrs">
                      <input type="checkbox" class="toggle-switch" id="AutoUpdate" name="AutoUpdate"> Auto update
                    </div>
                    <div style="padding-top: 0.7rem" title="If enabled NemosMiner will show the changlog when an update is available">
                      <input type="checkbox" class="toggle-switch" id="ShowChangeLog" name="ShowChangeLog"> Show change log
                    </div>
                    </fieldset>
                  <br>

                  <!-- Balance Tracker Settings -->
                  <fieldset>
                    <legend class=h6><b>Balance Tracker Settings</b></legend>
                      <div style="padding-top: 0.3rem" title="Interval duration to run background task to periodically collect pool balances & earnings data&#10;(min=10; max=60; [Default: 15; 0 to disable] minutes)&#10;&#10;Note: If set to 0 it will also disable pool balances summary in the Web GUI dashboard and API"> Poll pools for balances & earnings every
                        <input type="number" id="BalancesTrackerPollInterval" name="BalancesTrackerPollInterval" length=2 min=0 max=60 step=1 value=15> minutes
                      <div style="padding-top: 0.7rem" title="NemosMiner will store all balances tracker data in '.\Logs\BalancesTrackerLog.csv'">
                        <input type="checkbox" class="toggle-switch" id="BalancesTrackerLog" name="BalancesTrackerLog" style="margin-left:20px"> Write balances tracker log
                      </div>
                      <div style="padding-top: 0.7rem" title="Most pools clear pending balances after a longer period of inactivity.&#10;To avoid forfeiting pool balances NemosMiner will enforce mining&#10;at the pool the day before it would clear the balance.&#10;(one cycle only, even if it is not the most profitable pool).&#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)">
                        <input type="checkbox" class="toggle-switch" id="BalancesKeepAlive" name="BalancesKeepAlive" style="margin-left:20px"> Keep pool balances alive
                      </div>
                    </div>
                    <div style="padding-top: 0.7rem" title="Pool balances will be shown in all currencies (main & extra currencies) in web dashboard&#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)">
                      <input type="checkbox" class="toggle-switch" id="BalancesShowInAllCurrencies" name="BalancesShowInAllCurrencies" style="margin-left:20px"> Show pool balances in all currencies
                    </div>
                  </div>
                </fieldset>
                </td>
                <td>
                  <div style="line-height:100%" class="col-md-12">
                    <!-- Select Mining Devices -->
                    <fieldset title="Enable / disable mining devices&#10;&#10;Unsupported devices are greyed out and cannot be enabled.">
                      <legend class=h6><b>Select Mining Devices</b></legend>
                      <div id="Devices"></div>
                    </fieldset>
                    <br>

                    <!-- Select Pools -->
                    <fieldset title="You cannot select multiple variants of the same pool">
                      <legend class=h6><b>Select Pools</b></legend>
                      <div style="padding-top: 0.2rem;line-height:125%" id="Pools"></div>
                    </fieldset>
                    <br>

                    <!-- Select the Region closest to your Location -->
                    <fieldset title="Note: Region is also a per pool configuration item (edit .'\Config\PoolsConfig.json')">
                      <legend class=h6><b>Select the Region closest to your Location</b></legend>
                      <div style="padding-top: 0.2rem;line-height:125%" id="Regions"></div>
                    </fieldset>
                    <div style="padding-top: 0.2rem" title="Pools establish fastest network route based on your location&#10;Currently only ZergPool supports this feature.&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')">
                      <input type="checkbox" class="toggle-switch" id="UseAnycast" name="UseAnycast"> Use anycast for best network performance and ping times
                    </div>
                    <br>
                  </div>
                </td>
                <td>
                  <!-- Miner and Algorithm Selection -->
                  <legend title="" class=h6><b>Miner and Algorithm Selection</b></legend>
                  <div style="padding-top: 0.3rem" title="NemosMiner will run separate miner instances per GPU device model.&#10;Recommended for rigs with mixed GPU device models of the same vendor installed, e.g. GTX 1060 & GTX 1070&#10;This will increase profitability&#10;&#10;Note: AMD & NVIDIA cards will always run as separate instances.">
                    <input type="checkbox" class="toggle-switch" id="MinerInstancePerDeviceModel" name="MinerInstancePerDeviceModel"> Run separate miner instance per GPU device model
                  </div>
                  <div style="padding-top: 0.3rem" title="Select miner set to be used by NemosMiner">Use
                    <select name="" id="MinerSet" width="10">
                      <option title="The best miners chosen by the developers may not be the best miners for you" value=0>only best miner per algorithm and per device</option>
                      <option title="recommended, select to ensure best profitability" value=1>optimal miners (more than one per algorithm and device)</option>
                      <option title="This will prolongue benchmarking, but may not improve profitability" value=2>all miners (incl. those in UnprofitableAlgorithms.json)</option>
                    </select>
                  </div>
                  <div style="padding-top: 0.3rem" title="List of miners to be excluded&#10;Values must be sparated by commas&#10;&#10;To exclude all version of a miner specify the short miner name, e.g. 'PhoenixMiner' (without '-v...')&#10;To exclude a specific miner version use the full miner name (incl. version information)&#10;"> Exclude miners
                    <input type="text" id="ExcludeMinerName" name="ExcludeMinerName" size=50>
                  </div>
                  <div  style="padding-top: 0.2rem" title="'+[Algorithm]' to enable algorithm&#10;'-[Algorithm]' to disable algorithm&#10;Values must be sparated by commas&#10;Leave empty to use ALL available algorithms (not recommended as it may cause more switching)&#10;&#10;If '+' is used, then only the explicitly enabled algorithms are used&#10;If '-' is used, then all algorithms are used except the disabled ones&#10;You can either use '+' or '-'; you cannot combine both&#10;&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')"> Algorithms
                    <input type="text" id="Algorithm" name="Algorithm" size=50>
                    <button type="button" class="btn btn-light btn-sm" id="DefaultAlgorithm" name="DefaultAlgorithm" title="Load the default algorithm list&#10;for the selected pools">Load default algorithms</button>
                  </div>
                  <div style="padding-top: 0.7rem" title="NemosMiner will disable all miners which contain fees">
                    <input type="checkbox" class="toggle-switch" id="DisableMinersWithFee" name="DisableMinersWithFee"> Disable miners which contain miner fees
                  </div>
                  <div style="padding-top: 0.7rem" title="NemosMiner will disable all dual algorithm miners&#10;(Note: This will enable single algorithm mining)">
                    <input type="checkbox" class="toggle-switch" id="DisableDualAlgoMining" name="DisableDualAlgoMining"> Disable dual algorithm miners
                  </div>
                  <div style="padding-top: 0.7rem" title="NemosMiner will disable all single algorithm miners&#10;(Note: This will enable dual algorithm mining)">
                    <input type="checkbox" class="toggle-switch" id="DisableSingleAlgoMining" name="DisableSingleAlgoMining"> Disable single algorithm miners
                  </div>
                  <br>

                  <!-- Miner Runtime Settings -->
                  <legend title="Miner Runtime Settings" class=h6><b>Miner Runtime Settings</b></legend>
                  <div style="padding-top: 0.3rem" title="Miners will run as a hidden background task and are not accessible (not recommended)">
                    <input type="radio" id="MinerWindowStyleHidden" name="MinerWindowStyle" value="Hidden"> Run as hidden background task
                  </div>
                  <div style="padding-top: 0.4rem" title="Miner windows are minimized (default), but accessible">
                    <input type="radio" id="MinerWindowStyleMinimized" name="MinerWindowStyle" value="Minimized"> Run in minimized window
                  </div>
                  <div style="padding-top: 0.4rem" title="Miner windows are shown normally on desktop">
                    <input type="radio" id="MinerWindowStyleNormal" name="MinerWindowStyle" value="Normal"> Run in normal window
                  </div>
                  <div style="padding-top: 0.5rem" title="This is helpful to check the miner output for errors">
                    <input type="checkbox" class="toggle-switch" id="MinerWindowStyleNormalWhenBenchmarking" name="MinerWindowStyleNormalWhenBenchmarking"> Run in normal window while benchmarking
                  </div>
                  <div style="padding-top: 0.3rem" title="Select the process priority for CPU miners&#10;Higher priorities may lead to fluctuating hashrates with GPU miners">
                    <label for="CPUMinerProcessPriority">Run CPU miners with</label>
                    <select name="" id="CPUMinerProcessPriority">
                      <option value=1>above normal</option>
                      <option value=0>normal</option>
                      <option value=-1>below normal</option>
                      <option value=-2>idle</option>
                    </select>
                    <label for="CPUMinerProcessPriority">process priority</label>
                  </div>
                  <div title="Select the process priority for GPU miners&#10;Higher priorities may lead to fluctuating hashrates with CPU miners">
                    <label for="GPUMinerProcessPriority">Run GPU miners with</label>
                    <select name="" id="GPUMinerProcessPriority">
                      <option value=1>above normal</option>
                      <option value=0>normal</option>
                      <option value=-1>below normal</option>
                      <option value=-2>idle</option>
                    </select>
                    <label for="GPUMinerProcessPriority">process priority</label>
                  </div>
                  <div style="padding-top: 0.2rem" title="Enable miner specific tweaks, e.g. sharper memory timings or mild overclock&#10;&#10;Note: This may cause stability issues, use with caution!">
                    <input type="checkbox" class="toggle-switch" id="UseMinerTweaks" name="UseMinerTweaks"> Enable miner tweaks (admin rights required)
                  </div>
                  <div style="padding-top: 0.7rem" title="NemosMiner will disable developer fee mining&#10;(Note: not all miners support disabling their built in fees, others will reduce the hashrate.&#10;For miners that do not allow disabling the miner fees the effective fee will still be shown in the miner list.)">
                    <input type="checkbox" class="toggle-switch" id="DisableMinerFee" name="DisableMinerFee"> Disable miner fees
                  </div>
                  <br>

                  <!-- Power Cost Calculation Settings -->
                  <legend title="These settings are relevant for true profit calculation" class=h6><b>Power Cost Calculation Settings</b></legend>
                  <div style="padding-top: 0.3rem" title="Calculate power cost, required for true profit calculation&#10;Requires extra configuration of HWiNFO64&#10;(See ConfigHWinfo64.pdf)">
                    <input type="checkbox" class="toggle-switch" id="CalculatePowerCost" name="CalculatePowerCost"> Calculate power cost
                  </div>
                  <div style="padding-top: 0.3rem" id=PowerPricekWhTitle>
                    <label style="margin-left:20px" for="PowerPricekWh">Power price</label>
                    <input type="text" id="PowerPricekWh" name="PowerPricekWh" maxlength=128 size=24 value='{"00:00":0.0}'>
                    <label id="PowerPricekWhCurrency" for="PowerPricekWh">
                  </div>
                  <div title="Power usage of idle system. Part of profit calculation.&#10;(min=0, max=999 [Default: 60] W)">
                    <label style="margin-left:20px" for="PowerUsageIdleSystemW">Power usage of idle system</label>
                    <input type="number" step=1 min=0 max=999 value=60 size=3 id="PowerUsageIdleSystemW" name="PowerUsageIdleSystemW"> W
                  </div>
                  <div style="padding-top: 0.2rem" title="NemosMiner will ignore power cost in best miner selection&#10;and will select miners with best earnings (and not best profit)">
                    <input style="margin-left:20px" type="checkbox" class="toggle-switch" id="IgnorePowerCost" name="IgnorePowerCost"> Ignore power cost
                  </div>
                  <div style="padding-top: 0.5rem" id="ProfitabilityThresholdTitle">
                    <label style="margin-left:20px" for="ProfitabilityThreshold">Profitability threshold</label>
                    <input type="number" step="0.001" min=-999999 max=999999 id="ProfitabilityThreshold" name="ProfitabilityThreshold" value=0.0>
                    <label id="ProfitabilityThresholdCurrency" for="ProfitabilityThreshold">
                  </div>
                  <br>

                  <!-- Calculation Settings -->
                  <legend title="These settings are used to calculate the best miners" class=h6><b>Calculation Settings</b></legend>
                  <div style="padding-top: 0.3rem" title="Mark a pool as unavailable if price is x times higher than&#10;the second highest price of all other pools with same algorithm&#10;(min=1, max=10 [Default: 1.5; 1 disables this check])&#10;&#10;Note: This applies only to algorithms that have at least pools"> Unreal pool price factor
                    <input type="number" step=0.1 min=1 max=10 value=1.5 size=3 id="UnrealPoolPriceFactor" name="UnrealPoolPriceFactor">
                  </div>
                  <div style="padding-top: 0.3rem" title="Mark pool as unavailable if accuracy is below this value&#10;(min: 0%, max 100% [Default: 50%]"> Minimum accuracy
                    <input type="number" step=1 min=0 max=100 value=10 size=3 id="MinAccuracy" name="MinAccuracy"> %
                  </div>
                  <div style="padding-top: 0.5rem" title="NemosMiner will ignore the pool fee for earning & profit calculation">
                    <input type="checkbox" class="toggle-switch" id="IgnorePoolFee" name="IgnorePoolFee"> Ignore pool fees
                  </div>
                  <div style="padding-top: 0.5rem" title="Minimum workers mining the algorithm at the pool&#10;If less miners are mining the algorithm then the pool will be disabled.&#10;This is also a per pool setting configurable in 'PoolsConfig.json'&#10;(min=0, max=99; [Default: 10; 0 disables this check] workers)"> Minimum
                    <input type="number" step=1 min=0 max=99 value=10 size=3 id="MinWorker" name="MinWorker"> workers at pool
                  </div>
                  <div style="padding-top: 0.3rem" title="Default factor with which NemosMiner multiplies the prices reported by ALL pools.&#10;E.g. If you feel that the effective earnings seen at the pools are 20% lower than what NemosMiner projects&#10;then set Earnings Adjustment Factor to 0.80&#10;Note: This is also a per pool configuration item (edit .'\Config\PoolsConfig.json')&#10;(min=0.00, max=1.00 [Default: 1.00])" for="EarningsAdjustmentFactor"> Earnings adjustment factor
                    <input type="number" id="EarningsAdjustmentFactor" name="EarningsAdjustmentFactor" min=0 max=1 value=1 step=0.01 size=4>
                  </div>
                  <div style="padding-top: 0.3rem" title="Mark a miner as unavailable if earning is x times higher than the&#10;next best 10% or at least 5 miners with same algorithm&#10;(min=1, max=99 [Default: 5; 1 disables this check])">Unreal miner earning factor
                    <input type="number" step=0.1 min=1 max=99 value=5 size=3 id="UnrealMinerEarningFactor" name="UnrealMinerEarningFactor">
                  </div>
                  <div style="padding-top: 0.3rem" title="NemosMiner will not switch miners&#10;unless another miner has n% higher earnings / profit.&#10;&#10;Smaller numbers will cause more switching&#10;(min=0%, max=100% [Default: 5%])" for="MinerSwitchingThreshold">Miner switching threshold
                    <input type="number" id="MinerSwitchingThreshold" name="MinerSwitchingThreshold" min=0 max=100 value=5 step=0.1 size=3> %
                  </div>
                  <div style="padding-top: 0.5rem" title="NemosMiner will ignore the miner fee for earning & profit calculation">
                    <input type="checkbox" class="toggle-switch" id="IgnoreMinerFee" name="IgnoreMinerFee"> Ignore miner fees
                  </div>
                  <div style="padding-top: 0.3rem" title="Acceptable bad shares threshold ((invalid + rejected + stale) / total) as reported by the miner.&#10;If the threshold is exceeded then the miner will get stopped.&#10;(min: 0%, max 100% [Default: 5%; 0% disables this check])"> Acceptable bad shares threshold
                    <input type="number" step=1 min=0 max=100 value=5 size=3 id="BadShareRatioThreshold" name="BadShareRatioThreshold"> %
                  </div>
                  <div style="padding-top: 0.5rem" title="NemosMiner will deduct bad shares (e.g. invalid, rejected or stale) when calculating effective hashrates&#10;This will lower stored hashrates and increase earnings accuracy">
                    <input type="checkbox" class="toggle-switch" id="SubtractBadShares" name="SubtractBadShares"> Deduct bad shares when calculating effective hashrates
                  </div>
                  <br>

                  <!-- Main Text Window Display Settings -->
                  <legend class=h6 title="These Settings will not affect the information available in the in Web GUI"><b>Main Text Window Display Settings</b></legend>
                  <div title="'light' will not show information about previously run & failed miners and watchdog timers&#10;except while benchmarking or measuring power usage&#10;Can be toggled by pressing 's' in the text window while waiting for the next cycle"> UI Style
                    <select name="UIStyle" id="UIStyle">
                      <option value='full' title="Information about miners run in the past, failed miners & watchdog timers will be shown">full</option>
                      <option value='light' title="Information about miners run in the past, failed miners & watchdog timers will not be shown">light</option>
                    </select>
                  </div>
                  <div style="padding-top: 0.8rem" title="Show the 'PowerCost' column in the text window&#10;(requires 'Calculate Power Cost' to be enabled)&#10;&#10;Can be toggled by pressing 'c' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowPowerCost" name="ShowPowerCost"> Show power cost column
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'PowerUsage' column in the text window&#10;(requires 'Calculate Power Cost' to be enabled)&#10;&#10;Can be toggled by pressing 'w' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowPowerUsage" name="ShowPowerUsage"> Show power usage column
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'Profit' column in the text window&#10;(requires 'Calculate Power Cost' to be enabled)&#10;&#10;Can be toggled by pressing 't' in the text window while waiting for the next cycle&#10;">
                    <input type="checkbox" class="toggle-switch" id="ShowProfit" name="ShowProfit"> Show profit column
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'Profit Bias' column in the text window&#10;(requires 'Calculate Power Cost' to be enabled)&#10;&#10;Can be toggled by pressing 'r' in the text window while waiting for the next cycle&#10;">
                    <input type="checkbox" class="toggle-switch" id="ShowProfitBias" name="ShowProfitBias"> Show profit bias column
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'Earning' column in the text window&#10;&#10;Can be toggled by pressing 'e' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowEarning" name="ShowEarning"> Show earning column
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'Earning Bias' column in the text window&#10;&#10;Can be toggled by pressing 'i' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowEarningBias" name="ShowEarningBias"> Show earning bias column
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'Accuracy' column in the text window&#10;&#10;Can be toggled by pressing 'a' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowAccuracy" name="ShowAccuracy"> Show accuracy column
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'CoinName' column in the text window&#10;&#10;Can be toggled by pressing 'n' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowCoinName" name="ShowCoinName"> Show coin name column 
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'Currency' column in the text window&#10;&#10;Can be toggled by pressing 'y' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowCurrency" name="ShowCurrency"> Show currency column
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the 'User' column in the text window&#10;&#10;Can be toggled by pressing 'u' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowUser" name="ShowUser"> Show user column
                  </div>
                  <br>

                  <div title="When unticked only the best 5 miners per device are shown&#10;except while not benchmarking or measuring power usage&#10;&#10;Can be toggled by pressing 'v' in the text window while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowAllMiners" name="ShowAllMiners"> Show all miners
                  </div>
                  <div style="padding-top: 0.5rem" title="Show the Pool Balances in the text windows&#10;(requires 'Poll pools for balances & earnings every n minutes' to be > 0)&#10;&#10;Can be toggled by pressing 'b' in the text windows while waiting for the next cycle">
                    <input type="checkbox" class="toggle-switch" id="ShowPoolBalances" name="ShowPoolBalances" > Show pool balances
                  </div>
                  <br>

                  <!-- Web GUI Display Settings -->
                  <legend class=h6 title="These Settings will not affect the information available in the in the main text window"><b>Web GUI Display Settings</b></legend>
                  <div style="padding-top: 0.4rem" title="Miners and Rigs will be shown with colored background depending on status">
                    <input type="checkbox" class="toggle-switch" id="WebGUIUseColor" name="WebGUIUseColor"> Use colors for miner & rig status
                  </div>
                </td>
              </tr>
            </table>
            <br>
            <br>
          </form>
<!-- Start of page scripts 'configedit.html' -->
          <script type="text/javascript">

            const walletscontainer = document.getElementById('Wallets');
            const fiatcurrencycontainer = document.getElementById('Currency');
            const payoutcurrencycontainer = document.getElementById('PayoutCurrency');
            const poolscontainer = document.getElementById('Pools');
            const regionscontainer = document.getElementById('Regions');
            const devicescontainer = document.getElementById('Devices');

            var configfile = '';
            var regions = [];

            $(document).ready(function () {
              //Edit config file
              $('#btn-editconfig').click(function () {
                document.getElementById('btn-editconfig').disabled = true;
                document.getElementById('btn-editpoolsconfig').disabled = true;
                $('.modal-body').load('/functions/file/edit?FileName=' + configfile, function () {
                  if (this.outerText) {
                    $('.modal-title').text('Edit Config file');
                    $('#myModal').modal({ 
                      show: true
                    });
                    $('#myModal').on('hidden.bs.modal', function () {
                      location.reload(true);
                    })
                  }
                  document.getElementById('btn-editconfig').disabled = false;
                  document.getElementById('btn-editpoolsconfig').disabled = false;
                });
              });

              //Edit poolsconfig file
              $('#btn-editpoolsconfig').click(function () {
                document.getElementById('btn-editconfig').disabled = true;
                document.getElementById('btn-editpoolsconfig').disabled = true;
                $('.modal-body').load('/functions/file/edit?FileName=' + poolsconfigfile, function () {
                  if (this.outerText) {
                    $('.modal-title').text('Edit PoolsConfig file');
                    $('#myModal').modal({ 
                      show: true
                    });
                  }
                  document.getElementById('btn-editconfig').disabled = false;
                  document.getElementById('btn-editpoolsconfig').disabled = false;
                });
              });

              // Get FIAT currencies
              $.ajax({
                async: false,
                dataType: 'json',
                url: '/fiatcurrencies',
                success: function (result) {
                  fiatcurrencies = result;
                }
              });

              // Get config file names
              $.ajax({
                async: false,
                dataType: 'text',
                url: '/configfile',
                success: function (result) {
                  configfile = result;
                  $.ajax({
                    async: false,
                    dataType: 'text',
                    url: '/poolsconfigfile',
                    success: function (result) {
                      poolsconfigfile = result;
                      $('#configfilenames').text("Current configuration files: '" + configfile + "' & '" + poolsconfigfile + "'");
                    }
                  });
                }
              });

              // Wallet addresses and User Names
              // Fill wallet addresses
              $.each(config.Wallets, function (key, value) {
                key = key.toUpperCase();
                $('<label/>', { for: ('Wallet' + key), style: 'width:4rem', text: key }).appendTo(walletscontainer);
                if (key === 'BTC' || key === 'LTC') $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), maxlength: 35, size: 64 }).appendTo(walletscontainer);
                else if (key === 'ETC' || key === 'ETH') $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), maxlength: 42, size: 64 }).appendTo(walletscontainer);
                else $('<input/>', { type: 'text', id: ('Wallet' + key), value: value, name: ('Wallet' + key), size: 64 }).appendTo(walletscontainer);
                $('<br>').appendTo(walletscontainer);
                $('<option/>', { value: key, text: key }).appendTo(payoutcurrencycontainer);
              })
              document.getElementById('WorkerName').value = config.WorkerName.trim();
              // Mining Pool Hub
              document.getElementById('MiningPoolHubUserName').value = config.MiningPoolHubUserName;
              $(document.getElementById('MiningPoolHubUserName')).change(function (event) {
                document.getElementById('RegisterMiningPoolHub').hidden = Boolean(document.getElementById('MiningPoolHubUserName').value);
              });
              document.getElementById('MiningPoolHubAPIKey').value = config.MiningPoolHubAPIKey;
              // NiceHash
              document.getElementById('NiceHashWallet').value = config.NiceHashWallet;
              $(document.getElementById('NiceHashWallet')).change(function (event) {
                document.getElementById('RegisterNiceHash').hidden = Boolean(document.getElementById('NiceHashWallet').value);
              });
              document.getElementById('NiceHashAPIKey').value = config.NiceHashAPIKey;
              document.getElementById('NiceHashAPISecret').value = config.NiceHashAPISecret;
              document.getElementById('NiceHashWalletIsInternal').checked = config.NiceHashWalletIsInternal;
              // NiceHashWalletIsInternal
              $(document.getElementById('NiceHashWallet')).change(function (event) {
                document.getElementById('NiceHashWalletIsInternal').checked = Boolean(document.getElementById('NiceHashWallet').value);
                document.getElementById('NiceHashWalletIsInternal').disabled = (document.getElementById('NiceHashWallet')).value.notmatch(/^[0-9A-Za-z]{34}$/);
              });
              document.getElementById('NiceHashOrganizationId').value = config.NiceHashOrganizationId;
              // ProHashing
              document.getElementById('ProHashingUserName').value = config.ProHashingUserName;
              $(document.getElementById('ProHashingUserName')).change(function (event) {
                document.getElementById('RegisterProHashing').hidden = Boolean(document.getElementById('ProHashingUserName').value);
              });
              document.getElementById('ProHashingAPIKey').value = config.ProHashingAPIKey;
              if (config.ProHashingMiningMode === 'PPLNS') document.getElementById('ProHashingMiningMode').value = config.ProHashingMiningMode;
              else document.getElementById('ProHashingMiningMode').value = 'PPS';

              // Currency Settings
              $.each(fiatcurrencies, function(key, value) {
                $('<option/>', { value: key, text: key + ' (' + value + ')' }).appendTo(fiatcurrencycontainer);
              });
              document.getElementById('Currency').value = config.Currency.trim();
              document.getElementById('ExtraCurrencies').value = config.ExtraCurrencies.toString().trim();
              document.getElementById('PayoutCurrency').value = config.PayoutCurrency.trim();
              if (config.UsemBTC) document.getElementById('UsemBTC').checked = config.UsemBTC;

              // General Runtime Settings
              if (config.StartupMode === 'Idle' || config.StartupMode === 'Paused' || config.StartupMode === 'Running') document.getElementById('StartupMode').value = config.StartupMode;
              else document.getElementById('StartupMode').value = 'Idle';
              // StartPaused
              $(document.getElementById('AutoStart')).click(function (event) {
                document.getElementById('StartPaused').disabled = !(document.getElementById('AutoStart').checked);
              });
              if (config.IdleDetection) document.getElementById('IdleDetection').checked = true;
              else document.getElementById('IdleSec').disabled = true;
              document.getElementById('IdleSec').value = parseInt(config.IdleSec);
              if (config.StartPaused) document.getElementById('StartPaused').checked = true;
              // IdleSec
              $(document.getElementById('IdleDetection')).click(function (event) {
                document.getElementById('IdleSec').disabled = !(document.getElementById('IdleDetection').checked);
              });
              if (config.StartGUIMinimized) document.getElementById('StartGUIMinimized').checked = true;
              if (config.Watchdog) document.getElementById('Watchdog').checked = true;
              if (config.AutoReboot) document.getElementById('AutoReboot').checked = true;
              if (Number.isInteger(config.Donate)) document.getElementById('Donate').value = parseInt(config.Donate);
              // Donation nag
              if (parseInt(document.getElementById('Donate').value) <= 0) {
                $('.modal-title').html('&#128546  Donation duration set to 0 minutes  &#128546');
                $('.modal-body').html('Please help support the great team behind NemosMiner by leaving mining donations turned on.&#10;&#10;Thank you!');
                $('#myModal').modal({ show: true });
              };
              document.getElementById('Interval').value = parseInt(config.Interval);
              document.getElementById('MinDataSamples').value = parseInt(config.MinDataSamples);
              document.getElementById('MinInterval').value = parseInt(config.MinInterval);
              // if (config.SSL === 'Never' || config.SSL === 'Prefer' || config.SSL === 'Enforce') document.getElementById('SSL').value = config.SSL;
              // else document.getElementById('SSL').value = 'Prefer';
              document.getElementById('Proxy').value = config.Proxy.trim();
              if (config.OpenFirewallPorts) document.getElementById('OpenFirewallPorts').checked = true;

              // Auto Update Settings
              if (config.AutoUpdateCheckInterval) document.getElementById('AutoUpdateCheckInterval').value = parseInt(config.AutoUpdateCheckInterval)
              else document.getElementById('AutoUpdateCheckInterval').value = 1;
              if (config.AutoUpdate) document.getElementById('AutoUpdate').checked = true;
              if (config.ShowChangeLog) document.getElementById('ShowChangeLog').checked = true;

              // Balance Tracker Settings
              if (parseInt(config.BalancesTrackerPollInterval) >= 1 && parseInt(config.BalancesTrackerPollInterval) <= 9) document.getElementById('BalancesTrackerPollInterval').value = 10;
              else document.getElementById('BalancesTrackerPollInterval').value = parseInt(config.BalancesTrackerPollInterval);
              // Poll Pools for Balances & Earnings
              $(document.getElementById('BalancesTrackerPollInterval')).change(function (event) {
                if (document.getElementById('BalancesTrackerPollInterval').value == 9) document.getElementById('BalancesTrackerPollInterval').value = 0;
                if (document.getElementById('BalancesTrackerPollInterval').value == 1) document.getElementById('BalancesTrackerPollInterval').value = 10;
                if (document.getElementById('BalancesTrackerPollInterval').value > 1 && document.getElementById('BalancesTrackerPollInterval').value < 9) document.getElementById('BalancesTrackerPollInterval').value = 0;
                document.getElementById('BalancesTrackerLog').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
                document.getElementById('BalancesKeepAlive').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
                document.getElementById('ShowPoolBalances').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
                document.getElementById('BalancesShowInAllCurrencies').disabled = (parseInt(document.getElementById('BalancesTrackerPollInterval').value) == 0);
              });
              if (parseInt(config.BalancesTrackerPollInterval) == 0) {
                document.getElementById('BalancesTrackerLog').disabled = true;
                document.getElementById('BalancesTrackerLog').disabled = true;
                document.getElementById('BalancesKeepAlive').disabled = true;
                document.getElementById('BalancesShowInAllCurrencies').disabled = true;
              }
              if (config.BalancesTrackerLog) document.getElementById('BalancesTrackerLog').checked = true;
              if (config.BalancesKeepAlive) document.getElementById('BalancesKeepAlive').checked = true;

              // Select Mining Devices
              $.ajax({
                async: false,
                dataType: 'json',
                url: '/devices',
                success: function (result) {
                  devices = result;
                  $.each(devices, function (key, value) {
                    $('<input/>', { type: 'checkbox', class: 'toggle-switch', id: ('device-' + value.Name).toLowerCase(), value: value.Name, style: 'margin-top:0.3rem' }).appendTo(devicescontainer);
                    $('<label/>', { for: ('device-' + value.Name).toLowerCase(), text: (value.Name + ': ' + value.Model), style: 'margin-left:5px' }).appendTo(devicescontainer);
                    $('<br>').appendTo(devicescontainer);
                    if (value.State == 0) document.getElementById(('device-' + value.Name).toLowerCase()).checked = true;
                    if (value.State == 2) {
                      document.getElementById(('device-' + value.Name).toLowerCase()).disabled = true;
                      document.getElementById(('device-' + value.Name).toLowerCase()).checked = false;
                    }
                  })
                }
              });

              // Select Pools
              // Populate pool checkbox list
              $.ajax({
                async: false,
                dataType: 'json',
                url: '/poolvariants',
                success: function (result) {
                  poolvariants = result;
                  $.each(result, function (key, value) {
                    $('<input/>', { type: 'checkbox', class: 'toggle-switch', id: ('pool-' + value).toLowerCase(), value: value, style: 'margin-top:0.3rem' }).appendTo(poolscontainer);
                    $('<label/>', { for: ('pool-' + value).toLowerCase(), text: (value), style: 'margin-left:5px' }).appendTo(poolscontainer);
                    $('<br>').appendTo(poolscontainer);
                  })
                }
              });
              // Only one pool variant can be checked
              const Pools = document.getElementById('Pools');
              $(Pools).click(function (event) {
                var poolname = (event.target).id.toLowerCase();
                var basePoolName = poolname.replace('24hr', '').replace('coins', '').replace('plus', '');
                var pool = document.getElementById(basePoolName);
                if (pool && poolname != pool.id) pool.checked = false;
                var pool = document.getElementById(basePoolName + '24hr');
                if (pool && poolname != pool.id) pool.checked = false;
                var pool = document.getElementById(basePoolName + 'coins');
                if (pool && poolname != pool.id) pool.checked = false;
                var pool = document.getElementById(basePoolName + 'plus');
                if (pool && poolname != pool.id) pool.checked = false;
                var pool = document.getElementById(basePoolName + 'coinsplus');
                if (pool && poolname != pool.id) pool.checked = false;
                if (poolname.match('pool-miningpoolhub(|coins)$')) {
                  document.getElementById('MiningPoolHubUserName').disabled = !(document.getElementById(poolname).checked);
                  document.getElementById('MiningPoolHubAPIKey').disabled = !(document.getElementById(poolname).checked);
                };
                if (poolname == 'pool-nicehash') {
                  document.getElementById('NiceHashAPIKey').disabled = !(document.getElementById(poolname).checked);
                  document.getElementById('NiceHashAPISecret').disabled = !(document.getElementById(poolname).checked);
                  document.getElementById('NiceHashWallet').disabled = !(document.getElementById(poolname).checked);
                  document.getElementById('NiceHashWalletIsInternal').disabled = !(document.getElementById(poolname).checked);
                  document.getElementById('NiceHashOrganizationId').disabled = !(document.getElementById(poolname).checked);
                };
                if (poolname.match('pool-prohashing(|24hr|coins|coins24hr|coinsplus|plus)$')) {
                  document.getElementById('ProHashingUserName').disabled = !(document.getElementById(poolname).checked);
                  document.getElementById('ProHashingAPIKey').disabled = !(document.getElementById(poolname).checked);
                  document.getElementById('ProHashingMiningMode').disabled = !(document.getElementById(poolname).checked);
                };
              });
              $.each([config.PoolName].flat(), function (key, value) {
                if (document.getElementById(('pool-' + value).toString().toLowerCase())) document.getElementById(('pool-' + value).toString().toLowerCase()).checked = true;
              });
              document.getElementById('WorkerName').value = config.WorkerName.trim();
              document.getElementById('MiningPoolHubUserName').disabled = !(document.getElementById('pool-miningpoolhub').checked || (document.getElementById('pool-miningpoolhubcoins').checked));
              document.getElementById('MiningPoolHubAPIKey').disabled = !(document.getElementById('pool-miningpoolhub').checked || (document.getElementById('pool-miningpoolhubcoins').checked));
              document.getElementById('NiceHashAPIKey').disabled = !(document.getElementById('pool-nicehash').checked);
              document.getElementById('NiceHashAPISecret').disabled = !(document.getElementById('pool-nicehash').checked);
              document.getElementById('NiceHashWalletIsInternal').disabled = !(document.getElementById('pool-nicehash').checked);
              document.getElementById('NiceHashWallet').disabled = !(document.getElementById('pool-nicehash').checked);
              document.getElementById('NiceHashOrganizationId').disabled = !(document.getElementById('pool-nicehash').checked);
              document.getElementById('ProHashingUserName').disabled = !(document.getElementById('pool-prohashing').checked || document.getElementById('pool-prohashing24hr').checked || document.getElementById('pool-prohashingplus').checked);
              document.getElementById('ProHashingAPIKey').disabled = !(document.getElementById('pool-prohashing').checked || document.getElementById('pool-prohashing24hr').checked || document.getElementById('pool-prohashingplus').checked);
              document.getElementById('ProHashingMiningMode').disabled = !(document.getElementById('pool-prohashing').checked || document.getElementById('pool-prohashing24hr').checked || document.getElementById('pool-prohashingplus').checked);

              // Select the Region closest to your Location
              // Fill region list
              $.ajax({
                async: false,
                dataType: 'json',
                url: '/regions',
                success: function (result) {
                  regions = result;
                  $.each(regions, function (key, value) {
                    $('<input/>', { type: 'radio', id: ('region-' + value).toLowerCase(), value: value, name: 'Region' }).appendTo(regionscontainer);
                    $('<label/>', { for: ('region-' + value).toLowerCase(), text: value, style: 'margin-left:5px' }).appendTo(regionscontainer);
                    $('<br>').appendTo(regionscontainer);
                  })
                }
              });
              try {
                document.getElementById(('region-' + config.Region).toLowerCase()).checked = true;
              } catch {
                document.getElementById(('region-europe').toLowerCase()).checked = true;
              }
              if (config.UseAnycast) document.getElementById('UseAnycast').checked = true;

              // Miner and Algorithm Selection
              if (config.MinerInstancePerDeviceModel) document.getElementById('MinerInstancePerDeviceModel').checked = true;
              if (parseInt(config.MinerSet) >= 0 && parseInt(config.MinerSet) <= 2) document.getElementById('MinerSet').value = config.MinerSet;
              else document.getElementById('MinerSet').value = 1;
              if (config.ExcludeMinerName) document.getElementById('ExcludeMinerName').value = (config.ExcludeMinerName).toString().trim();
              if (config.Algorithm) document.getElementById('Algorithm').value = (config.Algorithm).toString().trim();
              //Load default Algorithm list
              $('#DefaultAlgorithm').click(function () {
                $.ajax({
                  async: false,
                  dataType: 'json',
                  url: '/defaultAlgorithm',
                  success: function (result) {
                    Algorithm.value = '+' + result.join(',+');
                  }
                });
              });
              if (config.DisableMinersWithFee) document.getElementById('DisableMinersWithFee').checked = true;
              if (config.DisableDualAlgoMining) document.getElementById('DisableDualAlgoMining').checked = true;
              if (config.DisableSingleAlgoMining) document.getElementById('DisableSingleAlgoMining').checked = true;
              // Dual AND single algorithm mining cannot be disabled at the same time
              $(document.getElementById('DisableDualAlgoMining')).click(function (event) {
                if (document.getElementById('DisableDualAlgoMining').checked) document.getElementById('DisableSingleAlgoMining').checked = false;
              });
              $(document.getElementById('DisableSingleAlgoMining')).click(function (event) {
                if (document.getElementById('DisableSingleAlgoMining').checked) document.getElementById('DisableDualAlgoMining').checked = false;
              });

              // Miner Runtime Settings
              if (config.MinerWindowStyle.toLowerCase() == 'hidden') document.getElementById('MinerWindowStyleHidden').checked = true;
              if (config.MinerWindowStyle.toLowerCase() == 'minimized') document.getElementById('MinerWindowStyleMinimized').checked = true;
              if (config.MinerWindowStyle.toLowerCase() == 'normal') document.getElementById('MinerWindowStyleNormal').checked = true;
              if (config.MinerWindowStyleNormalWhenBenchmarking) document.getElementById('MinerWindowStyleNormalWhenBenchmarking').checked = true;
              if (parseInt(config.CPUMinerProcessPriority) >= -2 && parseInt(config.CPUMinerProcessPriority) <= 1) document.getElementById('CPUMinerProcessPriority').value = config.CPUMinerProcessPriority;
              else document.getElementById('CPUMinerProcessPriority').value = -2;
              if (parseInt(config.GPUMinerProcessPriority) >= -2 && parseInt(config.GPUMinerProcessPriority) <= 1) document.getElementById('GPUMinerProcessPriority').value = config.GPUMinerProcessPriority;
              else document.getElementById('GPUMinerProcessPriority').value = -1;
              if (config.UseMinerTweaks) document.getElementById('UseMinerTweaks').checked = true;
              if (config.DisableMinerFee) document.getElementById('DisableMinerFee').checked = true;

              // Power Cost Calculation Settings
              if (config.CalculatePowerCost) document.getElementById('CalculatePowerCost').checked = true;
              else {
                document.getElementById('PowerPricekWh').disabled = true;
                document.getElementById('PowerUsageIdleSystemW').disabled = true;
                document.getElementById('IgnorePowerCost').disabled = true;
                document.getElementById('ProfitabilityThreshold').disabled = true;
              }
              document.getElementById('PowerPricekWh').value = JSON.stringify(config.PowerPricekWh);
              if (config.IgnorePowerCost) document.getElementById('IgnorePowerCost').checked = true;
              if (parseInt(config.PowerUsageIdleSystemW)) document.getElementById('PowerUsageIdleSystemW').value = parseInt(config.PowerUsageIdleSystemW);
              document.getElementById('ProfitabilityThreshold').value = config.ProfitabilityThreshold;
              document.getElementById('ProfitabilityThresholdCurrency').innerHTML = document.getElementById('Currency').value.split(',')[0];
              document.getElementById('PowerPricekWhCurrency').innerHTML = document.getElementById('Currency').value.split(',')[0] + ' per kW/h';
              document.getElementById('PowerPricekWhTitle').title = 'Price of power in ' + document.getElementById('Currency').value.split(',')[0] + ' per kW⋅h, valid from HH:mm (24hr format)\nData must be in compressed JSON format\n\ne.g. {"00:00":0.26; "12:00":0.3} means\nfrom 00:00h to 12:00h: ' + document.getElementById('Currency').value.split(',')[0] + ' 0.26 per kW/h\nfrom 12:00h to 23:59h: ' + document.getElementById('Currency').value.split(',')[0] + ' 0.30 per kW/h'
              document.getElementById('ProfitabilityThresholdTitle').title = 'Mining will stop when profit (earnings - power cost) is less than the configured value\n(e.g. ' + document.getElementById('Currency').value.split(',')[0] + ' 1.00)\n(except for benchmarking & power usage measuring)\n\nHint: Use negative numbers to allow mining at loss'
              // CalculatePowerCost click
              $(document.getElementById('CalculatePowerCost')).click(function (event) {
                document.getElementById('PowerPricekWh').disabled = !(document.getElementById('CalculatePowerCost').checked);
                document.getElementById('PowerUsageIdleSystemW').disabled = !(document.getElementById('CalculatePowerCost').checked);
                document.getElementById('IgnorePowerCost').disabled = !(document.getElementById('CalculatePowerCost').checked);
                document.getElementById('ProfitabilityThreshold').disabled = !(document.getElementById('CalculatePowerCost').checked);
              });
              // ProfitabilityThreshold
              $(document.getElementById('Currency')).change(function (event) {
                document.getElementById('ProfitabilityThresholdCurrency').innerHTML = document.getElementById('Currency').value.split(',')[0];
                document.getElementById('PowerPricekWhCurrency').innerHTML = '(time: ' + document.getElementById('Currency').value.split(',')[0] + ' per kW/h)';
                document.getElementById('PowerPricekWhTitle').title = 'Price of power in ' + document.getElementById('Currency').value.split(',')[0] + ' per kW⋅h, valid from HH:mm (24hr format)\nData must be in compressed JSON format\n\ne.g. {"00:00":0.26; "12:00":0.3} means\nfrom 00:00h to 12:00h: ' + document.getElementById('Currency').value.split(',')[0] + ' 0.26 per kW/h\nfrom 12:00h to 23:59h: ' + document.getElementById('Currency').value.split(',')[0] + ' 0.30 per kW/h'
                document.getElementById('ProfitabilityThresholdTitle').title = 'If profit (earnings - power cost) is less than the configured value\n(e.g. ' + document.getElementById('Currency').value.split(',')[0] + ' 1.00) then mining will stop\n(except for benchmarking & power usage measuring)\n\nHint: Use negative numbers to allow mining at loss'
              });

              // Calculation Settings
              document.getElementById('UnrealPoolPriceFactor').value = parseFloat(config.UnrealPoolPriceFactor);
              document.getElementById('MinAccuracy').value = parseFloat(config.MinAccuracy) * 100;
              if (config.IgnorePoolFee) document.getElementById('IgnorePoolFee').checked = true;
              document.getElementById('MinWorker').value = parseInt(config.MinWorker);
              document.getElementById('BadShareRatioThreshold').value = parseFloat(config.BadShareRatioThreshold) * 100;
              document.getElementById('EarningsAdjustmentFactor').value = parseFloat(config.EarningsAdjustmentFactor);
              document.getElementById('UnrealMinerEarningFactor').value = parseFloat(config.UnrealMinerEarningFactor);
              document.getElementById('MinerSwitchingThreshold').value = parseFloat(config.MinerSwitchingThreshold);
              if (config.SubtractBadShares) document.getElementById('SubtractBadShares').checked = true;
              if (config.IgnoreMinerFee) document.getElementById('IgnoreMinerFee').checked = true;

              // Main Text Window Display Settings
              if (config.UIStyle.trim().toLowerCase() == 'full') document.getElementById('UIStyle').value = 'full';
              else document.getElementById('UIStyle').value = 'light';
              if (config.ShowPowerCost) document.getElementById('ShowPowerCost').checked = true;
              if (config.ShowPowerUsage) document.getElementById('ShowPowerUsage').checked = true;
              if (config.ShowProfit) document.getElementById('ShowProfit').checked = true;
              if (config.ShowProfitBias) document.getElementById('ShowProfitBias').checked = true;
              if (config.ShowEarning) document.getElementById('ShowEarning').checked = true;
              if (config.ShowEarningBias) document.getElementById('ShowEarningBias').checked = true;
              if (config.ShowAccuracy) document.getElementById('ShowAccuracy').checked = true;
              if (config.ShowCoinName) document.getElementById('ShowCoinName').checked = true;
              if (config.ShowCurrency) document.getElementById('ShowCurrency').checked = true;
              if (config.ShowUser) document.getElementById('ShowUser').checked = true;
              if (config.ShowAllMiners) document.getElementById('ShowAllMiners').checked = true;
              if (config.ShowPoolBalances) document.getElementById('ShowPoolBalances').checked = true;
              if (config.BalancesShowInAllCurrencies) document.getElementById('BalancesShowInAllCurrencies').checked = true;
              // CalculatePowerCost click
              $(document.getElementById('CalculatePowerCost')).click(function (event) {
                document.getElementById('ShowPowerCost').disabled = !(document.getElementById('CalculatePowerCost').checked);
                document.getElementById('ShowPowerUsage').disabled = !(document.getElementById('CalculatePowerCost').checked);
                document.getElementById('ShowProfit').disabled = !(document.getElementById('CalculatePowerCost').checked);
                document.getElementById('ShowProfitBias').disabled = !(document.getElementById('CalculatePowerCost').checked);
              });
              // CalculatePowerCost checked
              if (config.CalculatePowerCost) document.getElementById('CalculatePowerCost').checked = true;
              else {
                document.getElementById('ShowPowerCost').disabled = true;
                document.getElementById('ShowPowerUsage').disabled = true;
                document.getElementById('ShowProfit').disabled = true;
                document.getElementById('ShowProfitBias').disabled = true;
              }
              // Web GUI Display Settings
              if (config.WebGUIUseColor) document.getElementById('WebGUIUseColor').checked = true;

              if (config && configfile && poolvariants && regions && devices) {
                document.getElementById('save-button').disabled = false;
              } else {
                $('.modal-title').text('Error reading configuration');
                $('.modal-body').html('This may be a temporary issue.&#10;Please refresh your browser window.&#10;&#10;If the problem persists restore the config file and restart NemosMiner.');
                $('#myModal').modal({ show: true });
              }

              $('#configuration').bind('reset', function () {
                location.reload(true);
              });

              $('#configuration').validate({
                rules: {
                  WalletBTC: {
                    required: false,
                    minlength: 34,
                    maxlength: 34,
                    pattern: '^[0-9A-Za-z]{34}$'
                  },
                  WalletETC: {
                    required: false,
                    minlength: 42,
                    maxlength: 42,
                    pattern: '^0[x|X][0-9A-Za-z]{40}$'
                  },
                  WalletETH: {
                    required: false,
                    minlength: 42,
                    maxlength: 42,
                    pattern: '^0[x|X][0-9A-Za-z]{40}$'
                  },
                  WorkerName: {
                    required: true,
                    minlength: 2,
                    maxlength: 32,
                    pattern: '^[0-9A-Za-z=\-]{2,32}$'
                  },
                  MiningPoolHubUserName: {
                    required: false,
                    minlength: 2,
                    maxlength: 32,
                    pattern: '^[0-9A-Za-z]{2,32}$'
                  },
                  MiningPoolHubAPIKey: {
                    required: false,
                    minlength: 64,
                    maxlength: 64,
                    pattern: '^[0-9a-f]{64}$'
                  },
                  NiceHashWallet: {
                    required: false,
                    minlength: 34,
                    maxlength: 34,
                    pattern: '^[0-9A-Za-z]{34}$'
                  },
                  NiceHashAPIKey: {
                    required: false,
                    minlength: 36,
                    maxlength: 36,
                    pattern: '^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$'
                  },
                  NiceHashAPISecret: {
                    required: false,
                    minlength: 72,
                    maxlength: 72,
                    pattern: '^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{20}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$'
                  },
                  NiceHashOrganizationId: {
                    required: false,
                    minlength: 36,
                    maxlength: 36,
                    pattern: '^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$'
                  },
                  ProHashingUserName: {
                    required: false,
                    minlength: 1,
                    maxlength: 32,
                    pattern: '^.{1,32}$'
                  },
                  ProHashingAPIKey: {
                    required: false,
                    minlength: 64,
                    maxlength: 64,
                    pattern: '^[0-9a-f]{64}$'
                  },
                  ExtraCurrencies: {
                    required: false,
                    minlength: 3,
                    maxlength: 64,
                    pattern: '^([A-Za-z0-9$]{3,4}?)+(?:,([A-Za-z0-9$]{3,4})+)*$'
                  },
                  IdleSec: {
                    digits: true,
                    range: [0, 3600],
                    required: true,
                    step: 1
                  },
                  Donate: {
                    digits: true,
                    range: [0, 60],
                    required: true,
                    step: 1
                  },
                  Interval: {
                    digits: true,
                    range: [30, 3600],
                    required: true,
                    step: 1
                  },
                  MinDataSamples: {
                    range: [10, 100],
                    required: true,
                    step: 1
                  },
                  MinInterval: {
                    digits: true,
                    range: [0, 10],
                    required: true,
                    step: 1
                  },
                  Proxy: {
                    required: false,
                    pattern: '^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                  },
                  AutoUpdateCheckInterval: {
                    digits: true,
                    range: [0, 30],
                    required: true,
                    step: 1
                  },
                  BalancesTrackerPollInterval: {
                    digits: true,
                    range: [0, 60],
                    required: true,
                    step: 1
                  },
                  ExcludeMinerName: {
                    required: false,
                    minlength: 4,
                    maxlength: 256,
                    pattern: '^([A-Za-z0-9\-\._]{4,}?)+(?:,(| )([A-Za-z0-9\-\._]{4,})+)*$'
                  },
                  Algorithm: {
                    required: false,
                    minlength: 3,
                    maxlength: 1024,
                    pattern: '^[+|-]([A-Za-z0-9]{2,}?)+(?:,[+|-]([A-Za-z0-9]{2,})+)*$'
                  },
                  PowerUsageIdleSystemW: {
                    digits: true,
                    range: [0, 999],
                    required: true,
                    step: 1
                  },
                  ProfitabilityThreshold: {
                    range: [-999999, 999999],
                    required: true,
                    step: 0.001
                  },
                  UnrealPoolPriceFactor: {
                    range: [1, 10],
                    required: true,
                    step: 0.1
                  },
                  MinAccuracy: {
                    range: [0, 100],
                    required: true,
                    step: 1
                  },
                  MinWorker: {
                    range: [0, 99],
                    required: true,
                    step: 1
                  },
                  EarningsAdjustmentFactor: {
                    range: [0, 1],
                    required: true,
                    step: 0.01
                  },
                  UnrealMinerEarningFactor: {
                    range: [1, 99],
                    required: true,
                    step: 0.1
                  },
                  MinerSwitchingThreshold: {
                    range: [0, 99],
                    required: true,
                    step: 0.1
                  },
                  BadShareRatioThreshold: {
                    range: [0, 100],
                    required: true,
                    step: 1
                  }
                },
                messages: {
                  Wallet: {
                    pattern: "<br>Bitcoin address must be exactly 34 characters long<br>and may only contain upper and lower case letters and digits<br>(case sensitive)"
                  },
                  WorkerName: {
                    pattern: "<br>Workername must be between 2 and 32 characters long<br>and may only contain upper and lower case letters and digits<br>(case sensitive)"
                  },
                  MiningPoolHubUserName: {
                    pattern: "<br>MiningPoolHub user name must be between 2 and 32 characters long<br>and may only contain upper and lower case letters and digits<br>(case sensitive)"
                  },
                  MiningPoolHubAPIKey: {
                    pattern: "<br>MiningPoolHub API key must be exactly 64 characters long<br>and may only contain lower case letters (a-f) and digits"
                  },
                  NiceHashWallet: {
                    pattern: "<br>NiceHash internal Bitcoin address must be exactly 34 characters long<br>and may only contain upper and lower case letters and digits<br>(case sensitive)"
                  },
                  NiceHashAPIKey: {
                    pattern: "<br>NiceHash internal Bitcoin address must be exactly 36 characters long<br>and must match '[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}'"
                  },
                  NiceHashAPISecret: {
                    pattern: "<br>NiceHash API secret must be exactly 72 characters long<br>and must match '[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{20}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}'"
                  },
                  NiceHashOrganizationId: {
                    pattern: "<br>NiceHash Organisation ID must be exactly 36 characters long<br>and must match '[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}'"
                  },
                  ProHashingUserName: {
                    pattern: "<br>ProHashing user name must be between 1 and 32 characters long"
                  },
                  ProHashingAPIKey: {
                    pattern: "<br>ProHashing API key must be exactly 64 characters long<br>and may only contain lower case letters (a-f) and digits"
                  },
                  Proxy: {
                    pattern: "<br>Enter Proxy IP V4 address and port<br>;e.g. 192.168.1.1:3128"
                  },
                  ExcludeMinerName: {
                    minlength: "<br>Miner Name is too short",
                    pattern: "<br>Miner names must separated by commas"
                  },
                  Algorithm: {
                    pattern: "<br>Algorithms must be prefixed with '+' or '-' and separated by commas"
                  }
                },
                submitHandler: function (form) {
                  document.body.style.cursor = 'wait';

                  // Wallet addresses and user names
                  $.each(config.Wallets, function (key, value) {
                    config.Wallets[key] = document.getElementById('Wallet' + key).value.toString();
                  });
                  config.WorkerName = document.getElementById('WorkerName').value.toString().trim();
                  if ((document.getElementById('WorkerName').value) == '') config.WorkerName = document.getElementById('WorkerName').value = 'WorkerName';
                  config.MiningPoolHubUserName = document.getElementById('MiningPoolHubUserName').value.toString().trim();
                  if ((document.getElementById('MiningPoolHubUserName').value) == '') config.MiningPoolHubUserName = document.getElementById('MiningPoolHubUserName').value = 'Nemo';
                  config.MiningPoolHubAPIKey = document.getElementById('MiningPoolHubAPIKey').value = document.getElementById('MiningPoolHubAPIKey').value.toString().trim();
                  config.NiceHashAPIKey = document.getElementById('NiceHashAPIKey').value = document.getElementById('NiceHashAPIKey').value.toString().trim();
                  config.NiceHashAPISecret = document.getElementById('NiceHashAPISecret').value = document.getElementById('NiceHashAPISecret').value.toString().trim();
                  config.NiceHashWallet = document.getElementById('NiceHashWallet').value = document.getElementById('NiceHashWallet').value.toString().trim();
                  config.NiceHashWalletIsInternal = document.getElementById('NiceHashWalletIsInternal').checked;
                  config.NiceHashOrganizationId = document.getElementById('NiceHashOrganizationId').value = document.getElementById('NiceHashOrganizationId').value.toString().trim();
                  config.ProHashingAPIKey = document.getElementById('ProHashingAPIKey').value = document.getElementById('ProHashingAPIKey').value.toString().trim();
                  config.ProHashingUserName = document.getElementById('ProHashingUserName').value = document.getElementById('ProHashingUserName').value.toString().trim();
                  config.ProHashingMiningMode = document.getElementById('ProHashingMiningMode').value;

                  // Currency settings
                  config.Currency = document.getElementById('Currency').value.trim();
                  config.ExtraCurrencies = []; // Enforce array
                  if (document.getElementById('ExtraCurrencies').value) config.ExtraCurrencies = (document.getElementById('ExtraCurrencies').value).replace(" ", "").split(",");
                  config.PayoutCurrency = document.getElementById('PayoutCurrency').value;
                  config.UsemBTC = document.getElementById('UsemBTC').checked;

                  // Runtime Settings
                  if (document.getElementById('StartupMode').value.match('Idle|Paused|Running')) config.StartupMode = document.getElementById('StartupMode').value;
                  else config.StartupMode = 'Idle';
                  config.IdleDetection = document.getElementById('IdleDetection').checked;
                  config.IdleSec = parseInt(document.getElementById('IdleSec').value);
                  config.StartGUIMinimized = document.getElementById('StartGUIMinimized').checked;
                  config.Watchdog = document.getElementById('Watchdog').checked;
                  config.AutoReboot = document.getElementById('AutoReboot').checked;
                  config.Donate = parseInt(document.getElementById('Donate').value);
                  config.Interval = parseInt(document.getElementById('Interval').value);
                  config.MinDataSamples = parseInt(document.getElementById('MinDataSamples').value);
                  config.MinInterval = parseInt(document.getElementById('MinInterval').value);
                  // if (document.getElementById('SSL').value.match('Never|Prefer|Enforce')) config.SSL = document.getElementById('SSL').value;
                  // else config.SSL = 'Prefer';
                  config.Proxy = document.getElementById('Proxy').value;
                  config.OpenFirewallPorts = document.getElementById('OpenFirewallPorts').checked;

                  // Auto Update Settings
                  config.AutoUpdateCheckInterval = parseInt(document.getElementById('AutoUpdateCheckInterval').value);
                  config.AutoUpdate = document.getElementById('AutoUpdate').checked;
                  config.ShowChangeLog = document.getElementById('ShowChangeLog').checked;

                  // Balance Tracker Settings
                  config.BalancesTrackerPollInterval = parseInt(document.getElementById('BalancesTrackerPollInterval').value);
                  config.BalancesTrackerLog = document.getElementById('BalancesTrackerLog').checked;
                  config.BalancesKeepAlive = document.getElementById('BalancesKeepAlive').checked;
                  config.BalancesShowInAllCurrencies = document.getElementById('BalancesShowInAllCurrencies').checked;
                  
                  // Select mining devices
                  config.ExcludeDeviceName = [];
                  $.each(devices, function (key, value) {
                    if (document.getElementById(('device-' + value.Name.toLowerCase())).checked == false && value.State != 2) (config.ExcludeDeviceName).push(value.Name);
                  });

                  // Select one or more pools
                  config.PoolName = [];
                  $.each(poolvariants, function (key, value) {
                    if (document.getElementById(('pool-' + value.toLowerCase())).checked == true) (config.PoolName).push(value);
                  });

                  // Select the region closest to your location
                  $.each(regions, function (key, value) {
                    if (document.getElementById('region-' + value.toLowerCase()).checked == true) config.Region = value;
                  });
                  config.UseAnycast = document.getElementById('UseAnycast').checked;

                  // Miner and Algorithm Selection
                  config.MinerInstancePerDeviceModel = document.getElementById('MinerInstancePerDeviceModel').checked;
                  config.MinerSet = parseInt(document.getElementById('MinerSet').value);
                  config.ExcludeMinerName = []; // Enforce array
                  if (document.getElementById('ExcludeMinerName').value) config.ExcludeMinerName = (document.getElementById('ExcludeMinerName').value).replace(' ', '').split(',');
                  config.Algorithm = []; // Enforce array
                  if (document.getElementById('Algorithm').value) config.Algorithm = (document.getElementById('Algorithm').value).replace(' ', '').split(',');
                  config.DisableMinersWithFee = document.getElementById('DisableMinersWithFee').checked;
                  config.DisableDualAlgoMining = document.getElementById('DisableDualAlgoMining').checked;
                  config.DisableSingleAlgoMining = document.getElementById('DisableSingleAlgoMining').checked;

                  // Miner Runtime Settings
                  if (document.getElementById('MinerWindowStyleHidden').checked) config.MinerWindowStyle = 'hidden';
                  if (document.getElementById('MinerWindowStyleMinimized').checked) config.MinerWindowStyle = 'minimized';
                  if (document.getElementById('MinerWindowStyleNormal').checked) config.MinerWindowStyle = 'normal';
                  config.MinerWindowStyleNormalWhenBenchmarking = document.getElementById('MinerWindowStyleNormalWhenBenchmarking').checked;
                  config.CPUMinerProcessPriority = parseInt(document.getElementById('CPUMinerProcessPriority').value);
                  config.GPUMinerProcessPriority = parseInt(document.getElementById('GPUMinerProcessPriority').value);
                  config.UseMinerTweaks = document.getElementById('UseMinerTweaks').checked;
                  config.DisableMinerFee = document.getElementById('DisableMinerFee').checked;

                  // Power Cost Calculation Settings
                  config.CalculatePowerCost = document.getElementById('CalculatePowerCost').checked;
                  document.getElementById('PowerPricekWh').value = document.getElementById('PowerPricekWh').value.replace('[', '').replace(']', '');
                  if (document.getElementById('PowerPricekWh').value.toString().trim() === '') document.getElementById('PowerPricekWh').value = '{"00:00":0.0}';
                  if (document.getElementById('PowerPricekWh').value.toString().trim().match(/^{"(([0-1]|)[0-9]|[2][0-3]):([0-5][0-9])":(\d+(\.\d+)?)+(?:,"(([0-1]|)[0-9]|[2][0-3]):([0-5][0-9])":(\d+(\.\d+)?)+)*\}$/)) config.PowerPricekWh = JSON.parse(document.getElementById('PowerPricekWh').value.toString().trim());
                  else {
                    $('.modal-title').text('Invalid Power Price data');
                    $('.modal-body').text('Enter a compressed json, e.g. {"00:00":0.26,"12:00":0.3}');
                    $('#myModal').modal({ show: true });
                    return false;
                  }
                  config.PowerUsageIdleSystemW = parseInt(document.getElementById('PowerUsageIdleSystemW').value);
                  config.IgnorePowerCost = document.getElementById('IgnorePowerCost').checked;
                  config.ProfitabilityThreshold = parseFloat(document.getElementById('ProfitabilityThreshold').value);

                  // Calculation Settings
                  config.UnrealPoolPriceFactor = parseFloat(document.getElementById('UnrealPoolPriceFactor').value);
                  config.MinAccuracy = parseFloat(document.getElementById('MinAccuracy').value) / 100;
                  config.IgnorePoolFee = document.getElementById('IgnorePoolFee').checked;
                  config.MinWorker = parseInt(document.getElementById('MinWorker').value);
                  config.EarningsAdjustmentFactor = parseFloat(document.getElementById('EarningsAdjustmentFactor').value);
                  config.UnrealMinerEarningFactor = parseFloat(document.getElementById('UnrealMinerEarningFactor').value);
                  config.MinerSwitchingThreshold = parseFloat(document.getElementById('MinerSwitchingThreshold').value);
                  config.IgnoreMinerFee = document.getElementById('IgnoreMinerFee').checked;
                  config.BadShareRatioThreshold = parseFloat(document.getElementById('BadShareRatioThreshold').value) / 100;
                  config.SubtractBadShares = document.getElementById('SubtractBadShares').checked;

                  // Main Text Window Display Settings
                  config.UIStyle = document.getElementById('UIStyle').value;
                  config.ShowPowerCost = document.getElementById('ShowPowerCost').checked;
                  config.ShowPowerUsage = document.getElementById('ShowPowerUsage').checked;
                  config.ShowProfit = document.getElementById('ShowProfit').checked;
                  config.ShowProfitBias = document.getElementById('ShowProfitBias').checked;
                  config.ShowEarning = document.getElementById('ShowEarning').checked;
                  config.ShowEarningBias = document.getElementById('ShowEarningBias').checked;
                  config.ShowAccuracy =  document.getElementById('ShowAccuracy').checked;
                  config.ShowCoinName =  document.getElementById('ShowCoinName').checked;
                  config.ShowCurrency =  document.getElementById('ShowCurrency').checked;
                  config.ShowUser =  document.getElementById('ShowUser').checked;
                  config.ShowPoolBalances = document.getElementById('ShowPoolBalances').checked;
                  config.ShowAllMiners = document.getElementById('ShowAllMiners').checked;

                  // Web GUI Display Settings
                  config.WebGUIUseColor = document.getElementById('WebGUIUseColor').checked;

                  if (config.PoolName.length >= 1) {
                    // Write current config
                    var $command = '/functions/config/set?' + encodeURIComponent(JSON.stringify(config));
                    $('.modal-body').load($command, function () {
                      $('.modal-title').text('Apply configuration');
                      $('#myModal').modal({ show: true });
                      document.body.style.cursor = 'default';
                      $('#myModal').on('hidden.bs.modal', function () { location.reload(true) })
                    });
                  } else {
                    // No pool selected
                    $('.modal-title').html('Error: Invalid configuration');
                    $('.modal-body').html('Cannot apply configuration - you must select at least one pool.');
                    document.body.style.cursor = 'default';
                    $('#myModal').modal({ show: true });
                  }
                }
              });
            });
          </script>
<!-- End of page scripts 'configedit.html' -->
<!--#include file="/parts/foot.html" -->